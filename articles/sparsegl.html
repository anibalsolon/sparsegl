<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with `sparsegl` • sparsegl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with `sparsegl`">
<meta property="og:description" content="An introductory tutorial with examples">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparsegl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sparsegl.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sparsegl_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with <code>sparsegl</code>
</h1>
            
      
      
      <div class="hidden name"><code>sparsegl.Rmd</code></div>

    </div>

    
    
<p>This package provides tools for fitting regularization paths for sparse group-lasso penalized learning problems. The model is fit for a sequence of the regularization parameter lambda.</p>
<p>The strengths and improvements that this package achieved compared to other sparse group-lasso packages are as follows:</p>
<ul>
<li><p>Fortran significantly speeds up the sparse group-lasso model building process.</p></li>
<li><p>“Strong rule” is implemented during coordinate descent step, screening out zero-coefficient variables which might not be detected by some conservative criteria.</p></li>
<li><p><code>X</code> can be a sparse input matrix passed as an argument in <code><a href="../reference/sparsegl.html">sparsegl()</a></code>, and it does not have to be a regular matrix.</p></li>
<li><p>Plots are made with functions package <code>ggplot2</code> instead of function <code>plot</code> from <code>base</code>, which provide better appearances and experience for visualization.</p></li>
<li><p>An extra function <code><a href="../reference/estimate_risk.html">estimate_risk()</a></code> evaluates the quality of fitted models in terms of different information criteria and provides a means for model selection. It is also an alternative for model selection if cross-validation is too costly.</p></li>
</ul>
<div id="installing" class="section level2">
<h2 class="hasAnchor">
<a href="#installing" class="anchor"></a>Installing</h2>
<p>This package is not on CRAN yet, so it can be installed using the [<code>devtools</code>] (<a href="https://cran.r-project.org/package=devtools" class="uri">https://cran.r-project.org/package=devtools</a>) package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"dajmcdon/sparsegl"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></code></pre></div>
<p>Building the vignettes, such as this getting started guide, takes a significant amount of time. They are not included in the package by default. If you want to include vignettes, then use this modified command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"dajmcdon/sparsegl"</span>, ref <span class="op">=</span> <span class="st">"main"</span>,
                          build_vignettes <span class="op">=</span> <span class="cn">TRUE</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>For this getting-started vignette, firstly, we will randomly generate <code>X</code>, an input matrix of predictors of dimension <code>n</code>-obs by <code>p</code>-feature. To initiate <code>y</code>, a real-valued vector (make it a vector rather a matrix),</p>
<ul>
<li>Linear Regression model: <span class="math inline">\(y = X\beta^* + \epsilon\)</span>.</li>
<li>Logistic regression model: <span class="math inline">\(y = (y_1, y_2, \cdots, y_n)\)</span>, where <span class="math inline">\(y_i \sim \text{Bernoulli}\left(\frac{1}{1 + \exp(-X_i \beta^*)}\right)\)</span>, <span class="math inline">\(i = 1, 2, \cdots, n.\)</span>
</li>
</ul>
<p>where the coefficient vector <span class="math inline">\(\beta^*\)</span> is specified as below, and the white noise <span class="math inline">\(\epsilon\)</span> following standard normal distribution serves as data variation. Then the sparse group-lasso problem is formulated as the sum of mean squared error ( linear regression) or logistic loss (logistic regression) and a convex combination of lasso penalty and group lasso penalty:</p>
<ul>
<li>Linear regression: <span class="math display">\[
\min_{\beta\in\mathbb{R}^p}\left(\frac{1}{2n} \rVert y - \sum_g X^{(g)}\beta^{(g)}\rVert_2^2 + (1-\alpha)\lambda\sum_g \sqrt{\text{bs}}\rVert\beta^{(g)}\rVert_2 + \alpha\lambda\rVert\beta\rVert_1 \right) \qquad (*).
\]</span>
</li>
<li>Logistic regression: <span class="math display">\[
\min_{\beta\in\mathbb{R}^p}\left(\frac{1}{2n}\sum_{i=1}^n \log\left(1 + \exp\left(-y_i\beta^\top X_i\right)\right) + (1-\alpha)\lambda\sum_g \sqrt{\text{bs}}\rVert\beta^{(g)}\rVert_2 + \alpha\lambda\rVert\beta\rVert_1 \right) \qquad (**).
\]</span>
</li>
</ul>
<p>where</p>
<ul>
<li><p><span class="math inline">\(X^{(g)}\)</span> is the submatrix of <span class="math inline">\(X\)</span> with columns corresponding to the features in group <span class="math inline">\(g\)</span>.</p></li>
<li><p><span class="math inline">\(\beta^{(g)}\)</span> is the corresponding coefficients of the features in group <span class="math inline">\(g\)</span>.</p></li>
<li><p><code>bs</code> is the length of <span class="math inline">\(\beta^{(g)}\)</span>.</p></li>
<li><p><span class="math inline">\(\alpha\)</span> adjusts the weight between lasso penalty and group-lasso penalty.</p></li>
<li><p><span class="math inline">\(\lambda\)</span> fine-tunes the size of penalty imposed on the model to control the number of nonzero coefficients of features, and furthermore, to avoid overfitting.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sparsegl</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1010</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span>
<span class="va">beta_star</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">p</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># Linear regression model</span>
<span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">beta_star</span> <span class="op">+</span> <span class="va">eps</span>

<span class="co"># Logistic regression model</span>
<span class="va">pr</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">beta_star</span><span class="op">)</span><span class="op">)</span>
<span class="va">y_binary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">pr</span><span class="op">)</span></code></pre></div>
</div>
<div id="sparsegl" class="section level2">
<h2 class="hasAnchor">
<a href="#sparsegl" class="anchor"></a><code>sparsegl()</code>
</h2>
<p>Given an input matrix <code>X</code>, and a response vector <code>y</code> (or a matrix with 1 column), a sparse group-lasso regularized linear model is fitted for a sequence of penalty parameter values in terms of penalized maximum likelihood. The penalty is composed of lasso penalty and group lasso penalty. The other main arguments the users might give are:</p>
<ul>
<li><p><code>group</code>: a vector with consecutive integers of length <code>p</code> indicating the grouping of the features. By default, each group only contains one feature if without initialization.</p></li>
<li><p><code>family</code>: A character string specifying the likelihood to use, could be either linear regression “gaussian” or logistic regression loss “binomial”. Default is “gaussian”.</p></li>
<li><p><code>pf</code>: a penalty vector of the length of the number of groups in total. Default value for each entry is the square-root of the corresponding size of each group, which is <span class="math inline">\(\sqrt{\text{bs}}\)</span> in <span class="math inline">\((*)\)</span> and <span class="math inline">\((**)\)</span> above.</p></li>
<li><p><code>asparse</code>: changes the weight of lasso penalty, referring to <span class="math inline">\(\alpha\)</span> in <span class="math inline">\((*)\)</span> and <span class="math inline">\((**)\)</span> above: <code>asparse</code> = <span class="math inline">\(1\)</span> gives the lasso penalty only. <code>asparse</code> = <span class="math inline">\(0\)</span> gives the group lasso penalty only. The default value of <code>asparse</code> is <span class="math inline">\(0.05\)</span>.</p></li>
<li><p><code>lower_bnd</code>: lower bound for coefficient values, a vector in length of 1 or the number of groups including non-positive numbers only. Default value for each entry is -<span class="math inline">\(\infty\)</span>.</p></li>
<li><p><code>upper_bnd</code>: upper bound for coefficient values, a vector in length of 1 or the number of groups including non-negative numbers only. Default value for each entry is <span class="math inline">\(\infty\)</span>.</p></li>
</ul>
<p>It returns a <code>sparsegl</code> object, and the main attribute of this object is:</p>
<ul>
<li>
<code>df</code>: the number of nonzero coefficients for each lambda value. This only represents an approximation to the exact degree-of-freedom. Detailed explanation can be checked under function <code><a href="../reference/estimate_risk.html">estimate_risk()</a></code> below.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparsegl.html">sparsegl</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="va">groups</span><span class="op">)</span></code></pre></div>
<div id="plotting-function-plot-for-sparsegl-object" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-function-plot-for-sparsegl-object" class="anchor"></a>Plotting function <code>plot()</code> for <code>sparsegl</code> object</h3>
<p>This function produces nonzero-only coefficient curves for each penalty parameter <code>lambda</code> values in the regularization path for a fitted <code>sparsegl</code> object. The arguments of this function are:</p>
<ul>
<li><p><code>y_axis</code>: can be set with either “coef” or “group”. Default is “coef”.</p></li>
<li><p><code>x_axis</code>: can be set with either “lambda” or “penalty”. Default is “lambda”.</p></li>
</ul>
<p>To elaborate on <code>y_axis</code> and <code>x_axis</code>:</p>
<ul>
<li><p>The plot with <code>y_axis</code> = “group” is the group norms against the log-<code>lambda</code> or the scaled group norm vector. Each group norm is defined by: <span class="math display">\[
\text{asparse}\times\rVert\beta^{(g)}\rVert_1 + (1 - \text{asparse})\times\sum_g\rVert\beta^{(g)}\rVert_2
\]</span> Curves are plotted in the same color if the corresponding features are in the same group. Notice that the number of curves shown on the plots could be less than the actual number of groups since only the groups containing nonzero features at least at one lambda in the sequence <code>lambda</code> are included.</p></li>
<li><p>The plot with <code>y_axis</code> = “coef” is the coefficients of features against the log-<code>lambda</code> or the scaled group norm vector. Each curve with a distinct color represents a feature. Again, only the features having nonzero coefficients at least at one lambda value in the sequence <code>lambda</code> are considered.</p></li>
<li><p>The plot with <code>x_axis</code> = “lambda” indicates the <code>x_axis</code> presenting with log-<code>lambda</code>.</p></li>
<li><p>The plot with <code>x_axis</code> = “penalty” indicates the <code>x_axis</code> presenting with the scaled group norm vector. Each element in this vector is defined by: <span class="math display">\[
\frac{\text{asparse}\times\rVert \beta\rVert_1 + (1-\text{asparse})\times\sum_g\rVert \beta^{(g)}\rVert_2}{\max_\beta\left(\text{asparse}\times\ \rVert \beta\rVert_1 + (1-\text{asparse})\times\sum_g\rVert \beta^{(g)}\rVert_2\right)}
\]</span></p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit1</span>, y_axis <span class="op">=</span> <span class="st">"group"</span>, x_axis <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></code></pre></div>
<p><img src="sparsegl_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit1</span>, y_axis <span class="op">=</span> <span class="st">"coef"</span>, x_axis <span class="op">=</span> <span class="st">"penalty"</span>, add_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="sparsegl_files/figure-html/unnamed-chunk-6-2.png" width="768"></p>
</div>
<div id="coef-predict-and-print-sparsegl-object" class="section level3">
<h3 class="hasAnchor">
<a href="#coef-predict-and-print-sparsegl-object" class="anchor"></a><code>coef()</code>, <code>predict()</code> and <code>print()</code> <code>sparsegl</code> object</h3>
<p>All three functions consume a fitted <code>sparsegl</code> object as an arguments and</p>
<ul>
<li><p><code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> and <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> return a matrix of coefficients and predictions <span class="math inline">\(\hat{y}\)</span> given a matrix <code>X</code> at each lambda respectively, unless an optional argument <code>s</code> is assigned with a specified vector or numeric value from (but not necessarily) the original <code>lambda</code> sequence.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/print.html">print()</a></code> returns the number of nonzero features with nonzero coefficients at each <code>lambda</code>.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit1</span>, s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit1</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="fl">100</span>,<span class="op">]</span>, s <span class="op">=</span> <span class="va">fit1</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="cv-sparsegl" class="section level2">
<h2 class="hasAnchor">
<a href="#cv-sparsegl" class="anchor"></a><code>cv.sparsegl()</code>
</h2>
<p>This function does a k-fold cross-validation (cv) on <code>sparsegl</code>. It takes the same arguments <code>X</code>, <code>y</code>, <code>group</code>, which are specified above, with additional argument <code>pred.loss</code>. It can be set with either “L2” or “L1” for linear regression model, “loss” or “misclass” for logistic regression model indicating the loss to use for cv error. This will return a <code>cv.sparseg</code> object.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv.sparsegl.html">cv.sparsegl</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="va">groups</span>, pred.loss <span class="op">=</span> <span class="st">"L1"</span><span class="op">)</span></code></pre></div>
<div id="plot-coef-and-predict-for-cv-sparsegl-object" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-coef-and-predict-for-cv-sparsegl-object" class="anchor"></a><code>plot()</code>, <code>coef()</code> and <code>predict()</code> for <code>cv.sparsegl</code> object</h3>
<ul>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>: produces cross-validation curve with upper and lower confidence bounds plots for each <code>lambda</code> in the regularization path for a fitted <code>cv.sparsegl</code> object. In the generated plot, the red points represent the <code>cvm</code> values at each <code>lambda</code>, and the attached gray vertical error bars indicate the uncertainty of <code>cvm</code>.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit_l1</span><span class="op">)</span></code></pre></div>
<p><img src="sparsegl_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> and <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> for <code>cv.sparsegl</code> object work similarly to those introduced above. The only differences are that the argument <code>object</code> passes a fitted <code>cv.sparsegl</code> object, and <code>s</code> can also be set with <code>lambda.1se</code>, <code>lambda.min</code> in addition.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit_l1</span>, s <span class="op">=</span> <span class="st">"lambda.1se"</span><span class="op">)</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_l1</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="fl">50</span><span class="op">:</span><span class="fl">80</span>, <span class="op">]</span>, s <span class="op">=</span> <span class="st">"lambda.min"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="estimate_risk" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate_risk" class="anchor"></a><code>estimate_risk()</code>
</h2>
<p>This function returns the information criterion, which is the sum of the maximum log-likelihood and a penalty term determined by the chosen penalty type for a <code>sparsegl</code> model at each <code>lambda</code>. It provides a means for model selection by representing the trade-off between the goodness of fit of the model and the complexity of the model. It takes the same arguments <code>X</code> and <code>y</code> from the function <code><a href="../reference/sparsegl.html">sparsegl()</a></code>. The additional arguments it needs are:</p>
<ul>
<li><p><code>object</code>: a fitted <code>sparsegl</code> object.</p></li>
<li>
<p><code>type</code>: three types of penalty used for calculation:</p>
<ul>
<li><p>AIC (Akaike information criterion): 2 * df / n</p></li>
<li><p>BIC (Bayesian information criterion): log(n) * df / n</p></li>
<li><p>GCV (Generalized cross validation): -2 * log(1 - df / n)</p></li>
</ul>
</li>
</ul>
<p>where df is the degree-of-freedom, and n is the sample size.</p>
<ul>
<li>
<code>approx_df</code>: indicate if a vector of the approximation to the degree-of-freedom at each penalty parameter <code>lambda</code> is used. Default is FALSE and the program will compute the unbiased estimate of the exact degree-of-freedom.</li>
</ul>
<p>FYI: Degree-of-freedom is a tool to assess the complexity of a statistical modeling procedure. <code>object$df</code>, the approximation to the degree-of-freedom is the number of nonzero coefficients of the model. Notice that it would take some time to calculate the unbiased estimate of the exact degreeo-of-freedom if <code>X</code> is complicated. For more details about how to realize this calculation, our method is implemented based on the paper <a href="https://arxiv.org/pdf/1212.6478.pdf" class="uri">https://arxiv.org/pdf/1212.6478.pdf</a>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">risk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_risk.html">estimate_risk</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">X</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"AIC"</span>, approx_df <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel J. McDonald.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
